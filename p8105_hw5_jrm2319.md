Homework 5
================

Set- up

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

### **Problem 2**

First set the following design elements:

Fix n=30 Fix σ=5

Set μ=0 and generate 5000 datasets from the model: x∼Normal\[μ,σ\].
Also, save mu and p-value arising from a test of H: mu = 0 and alpha =
0.05.

``` r
gen_p2 = function(n = 30, mu =  0, sigma = 5) {
  gen_data = tibble(
    x = rnorm(n, mean = mu, sd = sigma),
  )
  
  test_result = t.test(gen_data$x, mu = 0)
  tidy_result = broom::tidy(test_result)
  
  gen_data |>
    summarize(
      mu_hat = mean(x),
      sigma_hat = sd(x),
      p_value = tidy_result$p.value
    )
}

output = vector("list", 5000)

for (i in 1:5000) {
  output[[i]] = gen_p2(30)
}

gen_results = bind_rows(output)
```

Repeat the above for mu = 1-6

``` r
new_mus = c(1,2,3,4,5,6)

all_results = list()

for (mu in new_mus) {
  output = vector("list", 5000) 

  for (i in 1:5000) {
    output[[i]] = gen_p2(30, mu = mu)
  }
  
  gen_results = bind_rows(output)
  
   gen_results$mu = mu
   
    all_results[[as.character(mu)]] = gen_results
}

tot_results = bind_rows(all_results)
```

PLOT: showing the proportion of times the null was rejected and the true
value of mu.

``` r
tot_results = tot_results %>%
  mutate(
    rejection = p_value < 0.05
  )

rejection_proportion = tot_results %>%
  group_by(mu) %>%
  summarize(
    rejection_rate = mean(rejection)
  )

ggplot(rejection_proportion, aes(x = mu, y = rejection_rate)) +
  geom_line() + 
  geom_point() +
  labs(
    x = "True μ",
    y = "Proportion of Rejections",
  ) +
  theme_minimal()
```

![](p8105_hw5_jrm2319_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->
Describe the association between effect size and power:  
Based on the graph above, the power of the test increases as the true
value of mu increases. Therefore, we can see a positive relationship
between the true value of mu and power however, it does level off betwen
mu = 5 and mu = 6.

PLOT: The average estimation of mu_hat and the true value of mu.

``` r
avg_mu_hat = tot_results %>%
  group_by(mu) %>%
  summarize(
    avg_mu_hat = mean(mu_hat)
  )

ggplot(avg_mu_hat, aes(x = mu, y = avg_mu_hat)) +
  geom_line() +
  geom_point() +
  labs(
    x = "True μ", 
    y = "Average Estimate of μ_hat"
  ) +
  theme_minimal()
```

![](p8105_hw5_jrm2319_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->
PLOT: Average estimate of mu_hat only in samples for which the null was
rejected.

``` r
avg_mu_hat_rejected = tot_results %>%
  filter(rejection == TRUE) %>%
  group_by(mu) %>%
  summarize(
    avg_mu_hat_rejected = mean(mu_hat)
  )

ggplot(avg_mu_hat_rejected, aes(x = mu, y = avg_mu_hat_rejected)) +
  geom_line() + 
  geom_point() +
  labs(
    x = "True μ", 
    y = "Average Estimate of μ_hat"
  ) +
  theme_minimal()
```

![](p8105_hw5_jrm2319_files/figure-gfm/unnamed-chunk-6-1.png)<!-- --> Is
the sample average of μ_hat across tests for which the null is rejected
approximately equal to the true value of μ? Why or why not? The sample
average of μ_hat across tests for which the null is rejected is not
approximately equal to the true value of μ. Based on the graph, the
sample averages of μ_hat = 2, 3, and 4 are more than the true value of
μ. For example, in the first graph, we see that the average estimated
μ_hat = 2 has a true value of μ =2, however in the bottom graph the
average estimated μ_hat = 2 has a true value of μ = ~2.2.

Therefore, the sample average of μ_hat across tests for which the null
is rejected is larger than the true value of μ and therefore they are
not approximately equal.

But, for the sample average of μ_hat = 5 and 6, the null is rejected is
approximately equal to the true value of μ.

### **Problem 3**
